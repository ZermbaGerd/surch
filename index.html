<head>
    <link rel="stylesheet" href="style.css" />

    <!-- 
        Stops your browser from trying to move back to scroll spot on reload 
        Got this from here: https://stackoverflow.com/a/46722645
    -->
    <script>history.scrollRestoration = "manual"</script>

</head>

<body>

    <div id = "titleBox"> 
        <h1> Welcome to my HIST394 final project </h1>
        <a href="writeup.html">See the write-up</a>
    </div>

    <div id = "scrollBar">

    </div>

    <script>

        // Values for size of each tiktok - make sure these align with CSS
        const imgBlockHeight = 480;
        const imgBlockWidth = 270;
        const imgBlockMargin = 20;

        // the bottom tiktok
        var finalObj = null;

        // pixel amount for us to add new element after
        var maxScroll = imgBlockHeight;

        // Represents a social media post
        class ImgBlock {

            constructor() {
                this.box = this.createSelf();
                console.log(typeof(this.box));
            }

            // creates and returns an html element associated with this class
            createSelf() {
                const tempDiv = document.createElement("div");
                document.getElementById("scrollBar").appendChild(tempDiv);
                tempDiv.classList.add("imgBlock");
                return tempDiv;
            }

            addImage(img) {
                console.log(img);
                console.log(typeof(img));
                this.box.appendChild(img);
            }

        }

        class TikTok {

            constructor(filePath) {
                this.img = document.createElement('img');
                this.img.src = filePath;
                this.img.width = 1080;
                this.img.height = 1920;
                this.img.classList.add("tiktok");
            }
        }


        // check if you've scrolled to the maximum scroll limit
        function checkScroll() {
            // console.log(window.scrollY + "  " + maxScroll)
            if (window.scrollY >= maxScroll-15) {
                return true;
            }
            return false;
        }

        
        // each time you scroll, check for the maximum scroll limit
        window.addEventListener("scroll", () => {
            if(checkScroll()) {
                thingToDoWhenScrolled();
            }
        });


        // thing you do when you've reached bottom
        function thingToDoWhenScrolled() {
                imgBlock = new ImgBlock();

                imgNum = Math.floor(Math.random() * 17);

                tikkity = new TikTok('images/image'+imgNum+'.png');
                imgBlock.addImage(tikkity.img);
                document.getElementById("scrollBar").appendChild(imgBlock.box);
                // this works because finalTok next sibling will be null

                finalObj = imgBlock.box;
                maxScroll += imgBlockHeight + imgBlockMargin;
        }


        // Initializes a series of boxes before scrolling
        imgBlock = new ImgBlock();
        const shlort = imgBlock.box;

        const tikkitytok = new TikTok('images/image1.png')
        imgBlock.addImage(tikkitytok.img)

        imgBlock2 = new ImgBlock();
        const shlort2 = imgBlock2.box;

        imgBlock3 = new ImgBlock();
        const shlort3 = imgBlock3.box;

        finalObj = shlort3;


        document.getElementById("scrollBar").appendChild(shlort);
        document.getElementById("scrollBar").appendChild(shlort2);
        document.getElementById("scrollBar").appendChild(shlort3);
    </script>
</body>